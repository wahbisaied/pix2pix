********************************** pairing : 
Starting dataset preparation with updated logic...
Found 83 potential scan folders in the source directory.
Pairing assumption: A folder 'res_avg/SCAN_01/' is paired with 'res_phases/SCAN_01/'.
  - Pairing and copying for patient 1 (ID: 01-02-2001-NA-p4-43956):
    - AVG: 'avg.nii.gz' -> 'patient_1.nii.gz'
    - PHS: '1.000000-P4P119S303I00003 Gated 0.0A-31283.nii.gz' -> 'patient_1.nii.gz'
  - Pairing and copying for patient 2 (ID: 01-08-2001-NA-p4-95100):
    - AVG: 'avg.nii.gz' -> 'patient_2.nii.gz'
    - PHS: '1.000000-P4P119S304I00003 Gated 0.0A-48634.nii.gz' -> 'patient_2.nii.gz'
  - Pairing and copying for patient 3 (ID: 01-14-2001-NA-p4-84277):
    - AVG: 'avg.nii.gz' -> 'patient_3.nii.gz'
    - PHS: '1.000000-P4P119S306I00003 Gated 0.0A-62666.nii.gz' -> 'patient_3.nii.gz'
  - Pairing and copying for patient 4 (ID: 01-18-2001-NA-p4-84728):
    - AVG: 'avg.nii.gz' -> 'patient_4.nii.gz'
    - PHS: '1.000000-P4P119S307I00003 Gated 0.0A-00438.nii.gz' -> 'patient_4.nii.gz'
  - Pairing and copying for patient 5 (ID: 03-25-1998-NA-p4-57341):
    - AVG: 'avg.nii.gz' -> 'patient_5.nii.gz'
    - PHS: '1.000000-P4P102S300I00003 Gated 0.0A-11733.nii.gz' -> 'patient_5.nii.gz'
  - Pairing and copying for patient 6 (ID: 03-26-2000-NA-p4-41182):
    - AVG: 'avg.nii.gz' -> 'patient_6.nii.gz'
    - PHS: '1.000000-P4P114S300I00003 Gated 0.0A-26031.nii.gz' -> 'patient_6.nii.gz'
  - Pairing and copying for patient 7 (ID: 04-13-2000-NA-p4-15839):
    - AVG: 'avg.nii.gz' -> 'patient_7.nii.gz'
    - PHS: '1.000000-P4P114S301I00003 Gated 0.0A-45522.nii.gz' -> 'patient_7.nii.gz'
  - Pairing and copying for patient 8 (ID: 04-21-2000-NA-p4-11761):
    - AVG: 'avg.nii.gz' -> 'patient_8.nii.gz'
    - PHS: '1.000000-P4P114S302I00004 Gated 0.0A-08276.nii.gz' -> 'patient_8.nii.gz'
  - Pairing and copying for patient 9 (ID: 04-26-2000-NA-p4-06742):
    - AVG: 'avg.nii.gz' -> 'patient_9.nii.gz'
    - PHS: '1.000000-P4P115S300I00004 Gated 0.0A-61243.nii.gz' -> 'patient_9.nii.gz'
  - Pairing and copying for patient 10 (ID: 04-27-2000-NA-p4-87445):
    - AVG: 'avg.nii.gz' -> 'patient_10.nii.gz'
    - PHS: '1.000000-P4P114S304I00003 Gated 0.0A-14293.nii.gz' -> 'patient_10.nii.gz'
  - Pairing and copying for patient 11 (ID: 05-05-2000-NA-p4-38187):
    - AVG: 'avg.nii.gz' -> 'patient_11.nii.gz'
    - PHS: '1.000000-P4P114S303I00003 Gated 0.0A-53256.nii.gz' -> 'patient_11.nii.gz'
  - Pairing and copying for patient 12 (ID: 05-11-2000-NA-p4-22817):
    - AVG: 'avg.nii.gz' -> 'patient_12.nii.gz'
    - PHS: '1.000000-P4P115S301I00003 Gated 0.0A-94914.nii.gz' -> 'patient_12.nii.gz'
  - Pairing and copying for patient 13 (ID: 05-24-2000-NA-p4-91968):
    - AVG: 'avg.nii.gz' -> 'patient_13.nii.gz'
    - PHS: '1.000000-P4P116S301I00004 Gated 0.0A-51894.nii.gz' -> 'patient_13.nii.gz'
  - Pairing and copying for patient 14 (ID: 05-25-2000-NA-p4-95872):
    - AVG: 'avg.nii.gz' -> 'patient_14.nii.gz'
    - PHS: '1.000000-P4P115S302I00003 Gated 0.0A-96968.nii.gz' -> 'patient_14.nii.gz'
  - Pairing and copying for patient 15 (ID: 05-26-1999-NA-p4-39328):
    - AVG: 'avg.nii.gz' -> 'patient_15.nii.gz'
    - PHS: '1.000000-P4P107S300I00003 Gated 0.0A-97958.nii.gz' -> 'patient_15.nii.gz'
  - Pairing and copying for patient 16 (ID: 06-01-2000-NA-p4-44840):
    - AVG: 'avg.nii.gz' -> 'patient_16.nii.gz'
    - PHS: '1.000000-P4P115S303I00003 Gated 0.0A-65382.nii.gz' -> 'patient_16.nii.gz'
  - Pairing and copying for patient 17 (ID: 06-02-1999-NA-p4-89680):
    - AVG: 'avg.nii.gz' -> 'patient_17.nii.gz'
    - PHS: '1.000000-P4P107S301I00003 Gated 0.0A-25027.nii.gz' -> 'patient_17.nii.gz'
  - Pairing and copying for patient 18 (ID: 06-08-2000-NA-p4-12939):
    - AVG: 'avg.nii.gz' -> 'patient_18.nii.gz'
    - PHS: '1.000000-P4P115S304I00003 Gated 0.0A-71226.nii.gz' -> 'patient_18.nii.gz'
  - Pairing and copying for patient 19 (ID: 06-08-2000-NA-p4-87118):
    - AVG: 'avg.nii.gz' -> 'patient_19.nii.gz'
    - PHS: '1.000000-P4P116S300I00003 Gated 0.0A-09711.nii.gz' -> 'patient_19.nii.gz'
--> WARNING: No 'Gated 0.0A' file found in 'C:\Users\wahbi\OneDrive\res_phases\06-09-1998-NA-NA-78411 - see again'. Skipping.
  - Pairing and copying for patient 20 (ID: 06-09-1999-NA-p4-63882):
    - AVG: 'avg.nii.gz' -> 'patient_20.nii.gz'
    - PHS: '1.000000-P4P107S302I00003 Gated 0.0A-75975.nii.gz' -> 'patient_20.nii.gz'
--> WARNING: No 'Gated 0.0A' file found in 'C:\Users\wahbi\OneDrive\res_phases\06-15-1999-NA-p4-07025'. Skipping.
  - Pairing and copying for patient 21 (ID: 06-15-2000-NA-p4-76115):
    - AVG: 'avg.nii.gz' -> 'patient_21.nii.gz'
    - PHS: '1.000000-P4P115S305I00004 Gated 0.0A-36620.nii.gz' -> 'patient_21.nii.gz'
  - Pairing and copying for patient 22 (ID: 06-17-1998-NA-p4-43192):
    - AVG: 'avg.nii.gz' -> 'patient_22.nii.gz'
    - PHS: '1.000000-P4P103S301I00004 Gated 0.0A-40800.nii.gz' -> 'patient_22.nii.gz'
  - Pairing and copying for patient 23 (ID: 06-21-1999-NA-p4-00587):
    - AVG: 'avg.nii.gz' -> 'patient_23.nii.gz'
    - PHS: '1.000000-P4P107S303I00003 Gated 0.0A-34850.nii.gz' -> 'patient_23.nii.gz'
  - Pairing and copying for patient 24 (ID: 06-21-1999-NA-p4-15001):
    - AVG: 'avg.nii.gz' -> 'patient_24.nii.gz'
    - PHS: '1.000000-P4P108S301I00004 Gated 0.0A-48454.nii.gz' -> 'patient_24.nii.gz'
  - Pairing and copying for patient 25 (ID: 06-22-2000-NA-p4-94897):
    - AVG: 'avg.nii.gz' -> 'patient_25.nii.gz'
    - PHS: '1.000000-P4P116S302I00003 Gated 0.0A-00450.nii.gz' -> 'patient_25.nii.gz'
  - Pairing and copying for patient 26 (ID: 06-29-2000-NA-p4-10940):
    - AVG: 'avg.nii.gz' -> 'patient_26.nii.gz'
    - PHS: '1.000000-P4P116S303I00003 Gated 0.0A-54509.nii.gz' -> 'patient_26.nii.gz'
  - Pairing and copying for patient 27 (ID: 07-02-1999-NA-p4-21843):
    - AVG: 'avg.nii.gz' -> 'patient_27.nii.gz'
    - PHS: '1.000000-P4P108S302I00003 Gated 0.0A-59383.nii.gz' -> 'patient_27.nii.gz'
  - Pairing and copying for patient 28 (ID: 07-02-2003-NA-p4-14571):
    - AVG: 'avg.nii.gz' -> 'patient_28.nii.gz'
    - PHS: '1.000000-P4P100S300I00003 Gated 0.0A-29193.nii.gz' -> 'patient_28.nii.gz'
  - Pairing and copying for patient 29 (ID: 07-06-2000-NA-p4-38364):
    - AVG: 'avg.nii.gz' -> 'patient_29.nii.gz'
    - PHS: '1.000000-P4P116S304I00003 Gated 0.0A-78003.nii.gz' -> 'patient_29.nii.gz'
  - Pairing and copying for patient 30 (ID: 07-07-1999-NA-p4-93302):
    - AVG: 'avg.nii.gz' -> 'patient_30.nii.gz'
    - PHS: '1.000000-P4P107S304I00003 Gated 0.0A-57790.nii.gz' -> 'patient_30.nii.gz'
  - Pairing and copying for patient 31 (ID: 07-08-1999-NA-p4-52902):
    - AVG: 'avg.nii.gz' -> 'patient_31.nii.gz'
    - PHS: '1.000000-P4P108S303I00003 Gated 0.0A-04071.nii.gz' -> 'patient_31.nii.gz'
  - Pairing and copying for patient 32 (ID: 07-28-1999-NA-p4-56648):
    - AVG: 'avg.nii.gz' -> 'patient_32.nii.gz'
    - PHS: '1.000000-P4P108S305I00003 Gated 0.0A-16492.nii.gz' -> 'patient_32.nii.gz'
--> WARNING: No 'Gated 0.0A' file found in 'C:\Users\wahbi\OneDrive\res_phases\08-10-1998-NA-NA-85576 - see again'. Skipping.
  - Pairing and copying for patient 33 (ID: 09-29-1998-NA-p4-84934):
    - AVG: 'avg.nii.gz' -> 'patient_33.nii.gz'
    - PHS: '1.000000-P4P104S300I00003 Gated 0.0A-06982.nii.gz' -> 'patient_33.nii.gz'
--> WARNING: No 'Gated 0.0A' file found in 'C:\Users\wahbi\OneDrive\res_phases\10-06-1999-NA-p4-32263'. Skipping.
  - Pairing and copying for patient 34 (ID: 10-08-1998-NA-p4-53394):
    - AVG: 'avg.nii.gz' -> 'patient_34.nii.gz'
    - PHS: '1.000000-P4P106S301I10306 Gated 0.0A-59846.nii.gz' -> 'patient_34.nii.gz'
  - Pairing and copying for patient 35 (ID: 10-09-2000-NA-p4-39432):
    - AVG: 'avg.nii.gz' -> 'patient_35.nii.gz'
    - PHS: '1.000000-P4P117S300I00003 Gated 0.0A-74791.nii.gz' -> 'patient_35.nii.gz'
  - Pairing and copying for patient 36 (ID: 10-14-1999-NA-p4-65942):
    - AVG: 'avg.nii.gz' -> 'patient_36.nii.gz'
    - PHS: '1.000000-P4P110S300I00003 Gated 0.0A-47181.nii.gz' -> 'patient_36.nii.gz'
  - Pairing and copying for patient 37 (ID: 10-18-2000-NA-p4-23457):
    - AVG: 'avg.nii.gz' -> 'patient_37.nii.gz'
    - PHS: '1.000000-P4P118S306I00003 Gated 0.0A-44768.nii.gz' -> 'patient_37.nii.gz'
  - Pairing and copying for patient 38 (ID: 10-20-1999-NA-p4-34722):
    - AVG: 'avg.nii.gz' -> 'patient_38.nii.gz'
    - PHS: '1.000000-P4P112S301I00003 Gated 0.0A-56175.nii.gz' -> 'patient_38.nii.gz'
  - Pairing and copying for patient 39 (ID: 10-21-1997-NA-p4-86157):
    - AVG: 'avg.nii.gz' -> 'patient_39.nii.gz'
    - PHS: '1.000000-P4P101S300I00003 Gated 0.0A-78180.nii.gz' -> 'patient_39.nii.gz'
  - Pairing and copying for patient 40 (ID: 10-22-1999-NA-p4-18291):
    - AVG: 'avg.nii.gz' -> 'patient_40.nii.gz'
    - PHS: '1.000000-P4P109S304I00003 Gated 0.0A-87991.nii.gz' -> 'patient_40.nii.gz'
  - Pairing and copying for patient 41 (ID: 10-24-2000-NA-p4-64180):
    - AVG: 'avg.nii.gz' -> 'patient_41.nii.gz'
    - PHS: '1.000000-P4P117S301I00003 Gated 0.0A-30542.nii.gz' -> 'patient_41.nii.gz'
  - Pairing and copying for patient 42 (ID: 10-29-1999-NA-p4-73694):
    - AVG: 'avg.nii.gz' -> 'patient_42.nii.gz'
    - PHS: '1.000000-P4P109S300I00003 Gated 0.0A-93947.nii.gz' -> 'patient_42.nii.gz'
  - Pairing and copying for patient 43 (ID: 10-31-2000-NA-p4-39873):
    - AVG: 'avg.nii.gz' -> 'patient_43.nii.gz'
    - PHS: '1.000000-P4P117S302I00003 Gated 0.0A-54642.nii.gz' -> 'patient_43.nii.gz'
  - Pairing and copying for patient 44 (ID: 11-03-1999-NA-p4-34158):
    - AVG: 'avg.nii.gz' -> 'patient_44.nii.gz'
    - PHS: '1.000000-P4P111S301I00003 Gated 0.0A-62069.nii.gz' -> 'patient_44.nii.gz'
  - Pairing and copying for patient 45 (ID: 11-05-1999-NA-p4-00556):
    - AVG: 'avg.nii.gz' -> 'patient_45.nii.gz'
    - PHS: '1.000000-P4P109S301I00003 Gated 0.0A-27603.nii.gz' -> 'patient_45.nii.gz'
  - Pairing and copying for patient 46 (ID: 11-05-1999-NA-p4-16116):
    - AVG: 'avg.nii.gz' -> 'patient_46.nii.gz'
    - PHS: '1.000000-P4P110S301I00003 Gated 0.0A-51479.nii.gz' -> 'patient_46.nii.gz'
  - Pairing and copying for patient 47 (ID: 11-07-2000-NA-p4-77874):
    - AVG: 'avg.nii.gz' -> 'patient_47.nii.gz'
    - PHS: '1.000000-P4P117S303I00003 Gated 0.0A-45715.nii.gz' -> 'patient_47.nii.gz'
  - Pairing and copying for patient 48 (ID: 11-09-2000-NA-p4-73468):
    - AVG: 'avg.nii.gz' -> 'patient_48.nii.gz'
    - PHS: '1.000000-P4P118S302I00004 Gated 0.0A-43170.nii.gz' -> 'patient_48.nii.gz'
  - Pairing and copying for patient 49 (ID: 11-12-1999-NA-p4-44676):
    - AVG: 'avg.nii.gz' -> 'patient_49.nii.gz'
    - PHS: '1.000000-P4P110S303I00003 Gated 0.0A-15039.nii.gz' -> 'patient_49.nii.gz'
  - Pairing and copying for patient 50 (ID: 11-17-2000-NA-p4-43681):
    - AVG: 'avg.nii.gz' -> 'patient_50.nii.gz'
    - PHS: '1.000000-P4P117S304I00003 Gated 0.0A-10105.nii.gz' -> 'patient_50.nii.gz'
  - Pairing and copying for patient 51 (ID: 11-19-1998-NA-p4-84518):
    - AVG: 'avg.nii.gz' -> 'patient_51.nii.gz'
    - PHS: '1.000000-P4P105S300I00004 Gated 0.0A-69532.nii.gz' -> 'patient_51.nii.gz'
  - Pairing and copying for patient 52 (ID: 11-19-1999-NA-p4-97769):
    - AVG: 'avg.nii.gz' -> 'patient_52.nii.gz'
    - PHS: '1.000000-P4P109S305I00003 Gated 0.0A-36733.nii.gz' -> 'patient_52.nii.gz'
  - Pairing and copying for patient 53 (ID: 11-21-2000-NA-p4-79553):
    - AVG: 'avg.nii.gz' -> 'patient_53.nii.gz'
    - PHS: '1.000000-P4P117S305I00003 Gated 0.0A-96421.nii.gz' -> 'patient_53.nii.gz'
  - Pairing and copying for patient 54 (ID: 11-23-2000-NA-p4-68112):
    - AVG: 'avg.nii.gz' -> 'patient_54.nii.gz'
    - PHS: '1.000000-P4P118S304I00003 Gated 0.0A-53691.nii.gz' -> 'patient_54.nii.gz'
--> WARNING: No 'Gated 0.0A' file found in 'C:\Users\wahbi\OneDrive\res_phases\11-26-1999-NA-p4-13296'. Skipping.
--> WARNING: No 'Gated 0.0A' file found in 'C:\Users\wahbi\OneDrive\res_phases\11-26-1999-NA-p4-84295'. Skipping.
  - Pairing and copying for patient 55 (ID: 11-26-1999-NA-p4-94490):
    - AVG: 'avg.nii.gz' -> 'patient_55.nii.gz'
    - PHS: '1.000000-P4P110S305I00003 Gated 0.0A-93462.nii.gz' -> 'patient_55.nii.gz'
--> WARNING: No 'Gated 0.0A' file found in 'C:\Users\wahbi\OneDrive\res_phases\11-27-2000-NA-p4-15587'. Skipping.
  - Pairing and copying for patient 56 (ID: 11-28-2000-NA-p4-26752):
    - AVG: 'avg.nii.gz' -> 'patient_56.nii.gz'
    - PHS: '1.000000-P4P117S308I00003 Gated 0.0A-49546.nii.gz' -> 'patient_56.nii.gz'
  - Pairing and copying for patient 57 (ID: 12-01-1999-NA-p4-78209):
    - AVG: 'avg.nii.gz' -> 'patient_57.nii.gz'
    - PHS: '1.000000-P4P111S302I00003 Gated 0.0A-00279.nii.gz' -> 'patient_57.nii.gz'
  - Pairing and copying for patient 58 (ID: 12-01-2000-NA-p4-55956):
    - AVG: 'avg.nii.gz' -> 'patient_58.nii.gz'
    - PHS: '1.000000-P4P118S303I00003 Gated 0.0A-41245.nii.gz' -> 'patient_58.nii.gz'
  - Pairing and copying for patient 59 (ID: 12-03-1999-NA-p4-12989):
    - AVG: 'avg.nii.gz' -> 'patient_59.nii.gz'
    - PHS: '1.000000-P4P113S300I00003 Gated 0.0A-36501.nii.gz' -> 'patient_59.nii.gz'
  - Pairing and copying for patient 60 (ID: 12-03-1999-NA-p4-77845):
    - AVG: 'avg.nii.gz' -> 'patient_60.nii.gz'
    - PHS: '1.000000-P4P110S306I00003 Gated 0.0A-41304.nii.gz' -> 'patient_60.nii.gz'
  - Pairing and copying for patient 61 (ID: 12-03-1999-NA-p4-88085):
    - AVG: 'avg.nii.gz' -> 'patient_61.nii.gz'
    - PHS: '1.000000-P4P112S302I00004 Gated 0.0A-01455.nii.gz' -> 'patient_61.nii.gz'
  - Pairing and copying for patient 62 (ID: 12-04-2000-NA-p4-01309):
    - AVG: 'avg.nii.gz' -> 'patient_62.nii.gz'
    - PHS: '1.000000-P4P117S306I00003 Gated 0.0A-14456.nii.gz' -> 'patient_62.nii.gz'
  - Pairing and copying for patient 63 (ID: 12-07-2000-NA-p4-71576):
    - AVG: 'avg.nii.gz' -> 'patient_63.nii.gz'
    - PHS: '1.000000-P4P118S308I00005 Gated 0.0A-30116.nii.gz' -> 'patient_63.nii.gz'
  - Pairing and copying for patient 64 (ID: 12-07-2000-NA-p4-93663):
    - AVG: 'avg.nii.gz' -> 'patient_64.nii.gz'
    - PHS: '1.000000-P4P118S307I00003 Gated 0.0A-72109.nii.gz' -> 'patient_64.nii.gz'
  - Pairing and copying for patient 65 (ID: 12-10-1999-NA-p4-06338):
    - AVG: 'avg.nii.gz' -> 'patient_65.nii.gz'
    - PHS: '1.000000-P4P113S304I00003 Gated 0.0A-99274.nii.gz' -> 'patient_65.nii.gz'
  - Pairing and copying for patient 66 (ID: 12-10-1999-NA-p4-47741):
    - AVG: 'avg.nii.gz' -> 'patient_66.nii.gz'
    - PHS: '1.000000-P4P111S303I00003 Gated 0.0A-14754.nii.gz' -> 'patient_66.nii.gz'
  - Pairing and copying for patient 67 (ID: 12-10-1999-NA-p4-74377):
    - AVG: 'avg.nii.gz' -> 'patient_67.nii.gz'
    - PHS: '1.000000-P4P112S303I00003 Gated 0.0A-63894.nii.gz' -> 'patient_67.nii.gz'
  - Pairing and copying for patient 68 (ID: 12-11-2000-NA-p4-21364):
    - AVG: 'avg.nii.gz' -> 'patient_68.nii.gz'
    - PHS: '1.000000-P4P119S301I00003 Gated 0.0A-48593.nii.gz' -> 'patient_68.nii.gz'
--> WARNING: No 'Gated 0.0A' file found in 'C:\Users\wahbi\OneDrive\res_phases\12-13-2000-NA-p4-01861'. Skipping.
  - Pairing and copying for patient 69 (ID: 12-16-1999-NA-p4-24532):
    - AVG: 'avg.nii.gz' -> 'patient_69.nii.gz'
    - PHS: '1.000000-P4P111S304I00003 Gated 0.0A-79989.nii.gz' -> 'patient_69.nii.gz'
  - Pairing and copying for patient 70 (ID: 12-16-1999-NA-p4-33226):
    - AVG: 'avg.nii.gz' -> 'patient_70.nii.gz'
    - PHS: '1.000000-P4P113S301I00003 Gated 0.0A-45721.nii.gz' -> 'patient_70.nii.gz'
  - Pairing and copying for patient 71 (ID: 12-16-1999-NA-p4-90126):
    - AVG: 'avg.nii.gz' -> 'patient_71.nii.gz'
    - PHS: '1.000000-P4P112S304I00003 Gated 0.0A-47162.nii.gz' -> 'patient_71.nii.gz'
  - Pairing and copying for patient 72 (ID: 12-18-2000-NA-p4-89502):
    - AVG: 'avg.nii.gz' -> 'patient_72.nii.gz'
    - PHS: '1.000000-P4P119S302I00003 Gated 0.0A-55951.nii.gz' -> 'patient_72.nii.gz'
  - Pairing and copying for patient 73 (ID: 12-23-1999-NA-p4-79045):
    - AVG: 'avg.nii.gz' -> 'patient_73.nii.gz'
    - PHS: '1.000000-P4P113S302I00005 Gated 0.0A-43284.nii.gz' -> 'patient_73.nii.gz'
  - Pairing and copying for patient 74 (ID: 12-23-1999-NA-p4-79057):
    - AVG: 'avg.nii.gz' -> 'patient_74.nii.gz'
    - PHS: '1.000000-P4P112S305I00003 Gated 0.0A-57081.nii.gz' -> 'patient_74.nii.gz'
  - Pairing and copying for patient 75 (ID: 12-25-2000-NA-p4-47373):
    - AVG: 'avg.nii.gz' -> 'patient_75.nii.gz'
    - PHS: '1.000000-P4P119S305I00003 Gated 0.0A-38945.nii.gz' -> 'patient_75.nii.gz'

Preparation complete. 75 pairs of files were copied and renamed.

/*///////////////////////////
Unpaired Folders and Reason
The reason is the same for all 8 unpaired folders: the script could not find a file containing "Gated 0.0A" inside the corresponding folder in C:\Users\wahbi\OneDrive\res_phases.

Here is the list of the skipped folder IDs:

06-09-1998-NA-NA-78411 - see again ( The phase 0 scan file is missing )
06-15-1999-NA-p4-07025 ( name without A )
08-10-1998-NA-NA-85576 - see again (The phase 0 scan file is missing)
10-06-1999-NA-p4-32263 ( name without A )
11-26-1999-NA-p4-13296 ( name without A )
11-26-1999-NA-p4-84295 ( name without A )
11-27-2000-NA-p4-15587 ( name without A )
12-13-2000-NA-p4-01861 ( name without A )
What to do next
You should manually inspect these 8 folders inside your C:\Users\wahbi\OneDrive\res_phases directory. The issue is likely one of the following:

The folder is empty.
The phase 0 scan file is missing.
The file exists but is named differently and does not contain the text Gated 0.0A.
////////////////////////// 
# Change Log

This file tracks all modifications and actions performed on the project.

### 2025-09-18

-   **Project Documentation:**
    -   Created `summary.md` to provide a comprehensive overview of the project setup, custom scripts, and usage instructions.
    -   Created `changes.md` to begin a running log of all future changes.

-   **Bug Fix (Dataloader):**
    -   Corrected a bug in `data/nifti_aligned_dataset.py`.
    -   Changed `.convert('RGB')` to `.convert('L')` to ensure that NIfTI slices are correctly processed as single-channel grayscale images, matching the `--input_nc 1` and `--output_nc 1` training flags.

    ////////////////////
    python train.py --dataroot ./datasets/ct_phases_dataset --name ct_phase0_generator --model pix2pix --dataset_mode nifti_aligned --preprocess none --input_nc 1 --output_nc 1 --axial_slice

////////////////////////////
error : 
PS C:\Users\wahbi\OneDrive\Desktop\pytorch-CycleGAN-and-pix2pix> python train.py --dataroot ./datasets/ct_phases_dataset --name ct_phase0_generator --model pix2pix --dataset_mode nifti_aligned --preprocess none --input_nc 1 --output_nc 1 --axial_slice
>> 
----------------- Options ---------------
              axial_slice: True                                 [default: False]
               batch_size: 1
                    beta1: 0.5
          checkpoints_dir: ./checkpoints
           continue_train: False
                crop_size: 256
                 dataroot: ./datasets/ct_phases_dataset         [default: None]
             dataset_mode: nifti_aligned                        [default: aligned]
                direction: AtoB
             display_freq: 400
          display_winsize: 256
                    epoch: latest
              epoch_count: 1
                 gan_mode: vanilla
                init_gain: 0.02
                init_type: normal
                 input_nc: 1                                    [default: 3]
                  isTrain: True                                 [default: None]
                lambda_L1: 100.0
                load_iter: 0                                    [default: 0]
                load_size: 286
                       lr: 0.0002
           lr_decay_iters: 50
                lr_policy: linear
         max_dataset_size: inf
                    model: pix2pix                              [default: cycle_gan]
                 n_epochs: 100
           n_epochs_decay: 100
               n_layers_D: 3
                     name: ct_phase0_generator                  [default: experiment_name]
                      ndf: 64
                     netD: basic
                     netG: unet_256
                      ngf: 64
               no_dropout: False
                  no_flip: False
                  no_html: False
                     norm: batch
              num_threads: 4
                output_nc: 1                                    [default: 3]
                    phase: train
                pool_size: 0
               preprocess: none                                 [default: resize_and_crop]
               print_freq: 100
             save_by_iter: False
          save_epoch_freq: 5
         save_latest_freq: 5000
           serial_batches: False
                   suffix:
         update_html_freq: 1000
                use_wandb: False
                  verbose: False
       wandb_project_name: CycleGAN-and-pix2pix
----------------- End -------------------
Initialized with device cuda:0
dataset [NiftiAlignedDataset] was created
Traceback (most recent call last):
  File "C:\Users\wahbi\OneDrive\Desktop\pytorch-CycleGAN-and-pix2pix\train.py", line 33, in <module>
    dataset = create_dataset(opt)  # create a dataset given opt.dataset_mode and other options
  File "C:\Users\wahbi\OneDrive\Desktop\pytorch-CycleGAN-and-pix2pix\data\__init__.py", line 60, in create_dataset
    data_loader = CustomDatasetDataLoader(opt)
  File "C:\Users\wahbi\OneDrive\Desktop\pytorch-CycleGAN-and-pix2pix\data\__init__.py", line 88, in __init__
    self.dataloader = torch.utils.data.DataLoader(self.dataset, batch_size=opt.batch_size, shuffle=shuffle, sampler=self.sampler, num_workers=int(opt.num_threads))
                      ~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\wahbi\AppData\Local\Programs\Python\Python313\Lib\site-packages\torch\utils\data\dataloader.py", line 385, in __init__
    sampler = RandomSampler(dataset, generator=generator)  # type: ignore[arg-type]
  File "C:\Users\wahbi\AppData\Local\Programs\Python\Python313\Lib\site-packages\torch\utils\data\sampler.py", line 156, in __init__
    raise ValueError(
        f"num_samples should be a positive integer value, but got num_samples={self.num_samples}"
    )
ValueError: num_samples should be a positive integer value, but got num_samples=0

//////////////////////////////////////////////////////
cd c:\Users\wahbi\OneDrive\Desktop\pytorch-CycleGAN-and-pix2pix && python check_dimensions.py
Checking NIfTI file dimensions...
==================================================
Patient 1:
  TrainA shape: (64, 64, 100)
  TrainB shape: (64, 64, 100)
  Voxel size A: (np.float32(0.9766), np.float32(0.9766), np.float32(3.0))
  Voxel size B: (np.float32(0.9766), np.float32(0.9766), np.float32(3.0))

Patient 2:
  TrainA shape: (64, 64, 100)
  TrainB shape: (64, 64, 100)
  Voxel size A: (np.float32(0.9766), np.float32(0.9766), np.float32(3.0))
  Voxel size B: (np.float32(0.9766), np.float32(0.9766), np.float32(3.0))

Patient 3:
  TrainA shape: (64, 64, 100)
  TrainB shape: (64, 64, 100)
  Voxel size A: (np.float32(0.9766), np.float32(0.9766), np.float32(3.0))
  Voxel size B: (np.float32(0.9766), np.float32(0.9766), np.float32(3.0))

The script ran successfully! The results show that your NIfTI files have consistent dimensions:

Shape: All files are 64√ó64√ó100 voxels (width √ó height √ó depth)

Voxel size: 0.9766mm √ó 0.9766mm √ó 3.0mm spacing

Consistency: Both trainA and trainB datasets have matching dimensions across all patients
////////////////////////////////////////////////////////////////////

Performance comparison for your RTX 3060:

GPU training: ~100-1000x faster than CPU

CPU training: Even with 16 cores, significantly slower

Why GPU is faster:

Parallel processing: GPU has ~3584 CUDA cores vs 16 CPU cores

Matrix operations: Neural networks are matrix-heavy, GPU excels at this

Memory bandwidth: GPU memory is much faster for large tensors

To force CPU training (not recommended):

python train.py --dataroot ./datasets/ct_phases_dataset --name ct_phase0_generator --model pix2pix --dataset_mode nifti_aligned --preprocess none --input_nc 1 --output_nc 1 --axial_slice --gpu_ids -1

Copy
bash
Better optimization strategy:
Use GPU for training + CPU cores for data loading:

python train.py --dataroot ./datasets/ct_phases_dataset --name ct_phase0_generator_optimized --model pix2pix --dataset_mode nifti_aligned --preprocess none --input_nc 1 --output_nc 1 --axial_slice --batch_size 8 --num_threads 12 --netG unet_512 --resize_to 512

Copy
bash
Estimated training time:

GPU (current): ~2-4 hours for 200 epochs

CPU only: ~2-3 days for same epochs
////////////////////////////////////
Model Output: Individual 2D Images (Not 3D Volumes)
What the model generates:

Input: Single 2D slice (64√ó64 pixels from average CT)

Output: Single 2D slice (64√ó64 pixels of phase 0 CT)

Training: Each 2D slice is treated as a separate training sample

Your dataset breakdown:

75 NIfTI volumes √ó 100 slices per volume = 7,500 individual 2D training images

Each slice trains independently - no 3D context

During testing, the model will:

Take each 2D slice from input volume

Generate corresponding 2D phase 0 slice

Save individual 2D images (not reconstruct 3D volume)

To get full 3D output, you need to:

Run inference on all slices of a volume

Manually stack the generated 2D slices back into 3D NIfTI format

Current limitation:

Model has no 3D spatial awareness

Each slice processed independently

No consistency between adjacent slices guaranteed

For true 3D generation, you'd need:

3D U-Net architecture

3D convolutions

Much more GPU memory

Different dataset loader for 3D patches

Your current setup generates individual 2D images that you'd need to reassemble into 3D volumes post-processing.

///////////////////////////
Based on the training script, the iterations per epoch is calculated as:

Iterations per epoch = Dataset size √∑ Batch size

From your training settings:

Default epochs: 100 (initial) + 100 (decay) = 200 total epochs

Batch size: Depends on your GPU memory (1, 2, or 4 from your optimized script)

Dataset size: This depends on how many image pairs you have in your dataset

To find out your specific numbers, you can:

Check your dataset size by looking at your training folder:

dir /s "datasets\ct_phases_dataset\train" | find "File(s)"

Copy
cmd
Calculate iterations per epoch:

If you have 1000 image pairs and batch_size=2: 500 iterations per epoch

If you have 500 image pairs and batch_size=1: 500 iterations per epoch

Key training frequencies (from the code):

Print losses: Every 100 iterations (print_freq=100)

Display images: Every 400 iterations (display_freq=400)

Save latest model: Every 5000 iterations (save_latest_freq=5000)

Save epoch checkpoint: Every 5 epochs (save_epoch_freq=5)

The training script will print the dataset size when it starts: "The number of training images = {dataset_size}".

es, the number of iterations per epoch is fixed throughout all epochs (assuming you don't change the dataset or batch size).

Here's why:

Iterations per epoch = Dataset size √∑ Batch size

Since both values remain constant during training:

Dataset size: Fixed (same training images every epoch)

Batch size: Fixed (set at start of training)

Example:

Dataset: 1000 image pairs

Batch size: 2

Iterations per epoch: 500 (same for all 200 epochs)

What changes over epochs:

Learning rate: Decreases after epoch 100 (linear decay)

Model weights: Updated each iteration

Loss values: Generally decrease over time

What stays the same:

Number of iterations per epoch: Always 500 (in the example)

Batch size: Always 2

Dataset size: Always 1000 images

Total training iterations:

200 epochs √ó 500 iterations/epoch = 100,000 total iterations

The only way iterations per epoch would change is if you:

Modify the dataset (add/remove images)

Change the batch size mid-training

Use data augmentation that creates "virtual" samples

But in standard training, iterations per epoch remains constant


////////////////////////////////////////
The modified train_optimized.py now automatically saves all training logs to a text file with these features:

Automatic Log Saving:

Creates timestamped log file: training_log_YYYYMMDD_HHMMSS.txt

Saves training command and start time

Captures all terminal output (stdout and stderr)

Real-time Logging:

Shows output in terminal as usual

Simultaneously writes to log file

Uses flush() for immediate file writing

Complete Coverage:

Logs training progress, losses, epoch info

Captures errors and completion status

Records interruptions and timestamps

Example log file name: training_log_20241215_143022.txt

Now when you run python train_optimized.py, you'll see:

üìù Training logs will be saved to: training_log_20241215_143022.txt
‚è≥ Starting training...

Copy
All subsequent training output will appear in both terminal and the log file automatically.
///////////////////////////////////////////////
